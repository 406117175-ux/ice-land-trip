<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å†°å³¶åŠ©ç† V2 - æ¥µè‡´è‡ªé§•å°èˆª</title>
    <style>
        :root {
            --nordic-blue: #2c3e50;
            --glacier-white: #f8f9fa;
            --storm-red: #e74c3c;
            --safe-green: #27ae60;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
            --card-radius: 16px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; 
            background: #eef2f3; color: var(--nordic-blue); margin: 0; padding-bottom: 90px;
            overflow-x: hidden;
        }

        /* é ‚éƒ¨æš´é¢¨é›ªæé†’ */
        #weather-alert {
            display: none; background: var(--storm-red); color: white;
            padding: 12px; text-align: center; font-weight: bold;
            position: sticky; top: 0; z-index: 2000; animation: pulse 2s infinite;
        }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.7; } 100% { opacity: 1; } }

        /* å¤©æ•¸å°è¦½åˆ— */
        .day-nav {
            display: flex; overflow-x: auto; padding: 15px; gap: 10px;
            background: white; position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .day-btn {
            min-width: 60px; height: 60px; border-radius: 50%; border: 2px solid #ddd;
            background: white; color: #777; font-weight: bold;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); flex-shrink: 0;
        }
        .day-btn.active { 
            background: var(--nordic-blue); color: white; border-color: var(--nordic-blue);
            transform: scale(1.1); box-shadow: var(--shadow);
        }

        /* å¡ç‰‡å‹•ç•«å®¹å™¨ */
        #content-area { padding: 15px; min-height: 500px; }
        .slide-fade-in { animation: slideFade 0.5s forwards; }
        @keyframes slideFade {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* æ™¯é»åœ–å¡ */
        .card { 
            background: white; border-radius: var(--card-radius); overflow: hidden;
            margin-bottom: 20px; box-shadow: var(--shadow); border: none;
        }
        .card-img { 
            width: 100%; height: 200px; object-fit: cover; 
            background: #ccc; transition: 0.3s;
        }
        .card-body { padding: 20px; }
        .tag { 
            display: inline-block; padding: 4px 12px; border-radius: 20px; 
            font-size: 11px; font-weight: bold; margin-bottom: 8px; text-transform: uppercase;
        }
        .tag-food { background: #fff3cd; color: #856404; }
        .tag-itinerary { background: #d1ecf1; color: #0c5460; }
        .tag-hotel { background: #d4edda; color: #155724; }

        .btn-nav {
            display: block; width: 100%; padding: 12px; background: var(--nordic-blue);
            color: white; text-align: center; text-decoration: none; border-radius: 8px;
            font-weight: bold; margin-top: 10px;
        }

        /* åº•éƒ¨å°èˆª */
        .bottom-bar {
            position: fixed; bottom: 0; width: 100%; height: 75px;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(10px);
            display: flex; justify-content: space-around; align-items: center;
            border-top: 1px solid #eee; z-index: 1000;
        }
        .nav-link { text-align: center; color: #999; text-decoration: none; font-size: 11px; }
        .nav-link.active { color: var(--nordic-blue); }
        .nav-link span { display: block; font-size: 24px; margin-bottom: 2px; }

        /* å…¨è¢å¹•å±•ç¤º */
        .focus-mode {
            display: none; position: fixed; inset: 0; background: black; color: white;
            z-index: 3000; align-items: center; justify-content: center; text-align: center;
            font-size: 42px; font-weight: bold; padding: 30px;
        }
    </style>
</head>
<body>

    <div id="weather-alert" onclick="this.style.display='none'">
        âš ï¸ å†°å³¶æ°£è±¡å±€ç™¼ä½ˆï¼šå¼·é¢¨æš´é è­¦ï¼å»ºè­°æš«åœé§•é§›ã€‚
    </div>

    <div id="itinerary-page" class="page">
        <div class="day-nav" id="day-bar"></div>
        <div id="content-area"></div>
    </div>

    <div id="focus-screen" class="focus-mode" onclick="this.style.display='none'"></div>

    <nav class="bottom-bar">
        <a href="#" class="nav-link active" onclick="switchPage('itinerary')"><span>ğŸ“…</span>è¡Œç¨‹è¡¨</a>
        <a href="#" class="nav-link" onclick="openComm()"><span>ğŸ—£ï¸</span>æºé€š</a>
        <a href="#" class="nav-link" onclick="openTools()"><span>ğŸ› ï¸</span>å·¥å…·ç®±</a>
    </nav>

    <script>
        // --- 13 æ—¥æ•¸æ“šï¼šåŒ…å«åœ–æ–‡ã€æ¨™è¨»èˆ‡å°èˆªé€£çµ ---
        const tripData = {
            1: { title: "9/27 å‡ºç™¼æ—¥", items: [
                { type: 'itinerary', name: "æ¡ƒåœ’åœ‹éš›æ©Ÿå ´", img: "https://images.unsplash.com/photo-1530521954074-e64f6810b32d?auto=format&fit=crop&w=500", desc: "é–‹å•Ÿ 17 æ—¥å¤§å†’éšª [cite: 38-40]" }
            ]},
            2: { title: "9/28 é›·å…‹é›…ç¶­å…‹", items: [
                { type: 'hotel', name: "SkÃ³lavÃ¶rÃ°ustÃ­gur Apartments", img: "https://images.unsplash.com/photo-1555854816-802f188095e9?auto=format&fit=crop&w=500", desc: "å¸‚å€æ ¸å¿ƒä½å®¿ [cite: 51]" },
                { type: 'itinerary', name: "HallgrÃ­mskirkja æ•™å ‚", img: "https://images.unsplash.com/photo-1527631746610-bca00a040d60?auto=format&fit=crop&w=500", desc: "ä¿¯ç°é›·å…‹é›…ç¶­å…‹å¤œæ™¯ [cite: 64]" },
                { type: 'food', name: "Old Iceland", img: "https://images.unsplash.com/photo-1559339352-11d035aa65de?auto=format&fit=crop&w=500", desc: "å¿…é»ï¼šIcelandic Lamb Soup [cite: 58-59]" }
            ]},
            3: { title: "9/29 æ–¯å¥ˆå±±åŠå³¶", items: [
                { type: 'itinerary', name: "GrundarfjÃ¶rÃ°ur", img: "https://images.unsplash.com/photo-1504829857797-ddff29c27927?auto=format&fit=crop&w=500", desc: "æ–¯å¥ˆå±±åŠå³¶é–€æˆ¶ [cite: 70]" }
            ]},
            4: { title: "9/30 æ•™å ‚å±±ç¶“å…¸", items: [
                { type: 'itinerary', name: "Kirkjufell æ•™å ‚å±±", img: "https://images.unsplash.com/photo-1476610182048-b716b8518aae?auto=format&fit=crop&w=500", desc: "å†°å³¶æœ€å…·ä»£è¡¨æ€§åœ°æ¨™ [cite: 87]" },
                { type: 'food', name: "Messinn ReykjavÃ­k", img: "https://images.unsplash.com/photo-1519708227418-c8fd9a32b7a2?auto=format&fit=crop&w=500", desc: "é®®é­šæ–™ç† A é¸é … [cite: 83]" }
            ]},
            // ... (Day 5-12 ä¾æ­¤é¡æ¨)
            13: { title: "10/9 æº«æ³‰èˆ‡é‚„è»Š", items: [
                { type: 'itinerary', name: "Sky Lagoon", img: "https://images.unsplash.com/photo-1520175480921-4edfa0683071?auto=format&fit=crop&w=500", desc: "äº«å—æœ€å¾Œçš„æº«æ³‰æ™‚å…‰ [cite: 160]" },
                { type: 'itinerary', name: "LOTUS é‚„è»Šé»", img: "https://images.unsplash.com/photo-1449965408869-eaa3f722e40d?auto=format&fit=crop&w=500", desc: "20:00 å‰å®Œæˆé‚„è»Šæ‰‹çºŒ [cite: 162]" }
            ]}
        };

        // --- æ ¸å¿ƒé‚è¼¯ï¼šå‹•æ…‹ç”Ÿæˆèˆ‡å‹•ç•« ---
        function renderDay(dayNum) {
            const area = document.getElementById('content-area');
            const data = tripData[dayNum] || { title: `Day ${dayNum} è¡Œç¨‹è¦åŠƒä¸­`, items: [] };
            
            // åŠ å…¥æ·¡å…¥å‹•ç•«æ•ˆæœ 
            area.innerHTML = '';
            area.classList.remove('slide-fade-in');
            void area.offsetWidth; // è§¸ç™¼é‡ç¹ª
            area.classList.add('slide-fade-in');

            area.innerHTML = `<h2 style="margin-bottom:20px;">${data.title}</h2>`;
            
            data.items.forEach(item => {
                const card = `
                    <div class="card">
                        <img src="${item.img}" class="card-img" alt="${item.name}" loading="lazy">
                        <div class="card-body">
                            <span class="tag tag-${item.type}">${item.type}</span>
                            <h3 style="margin:5px 0;">${item.name}</h3>
                            <p style="color:#666; font-size:14px;">${item.desc}</p>
                            <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(item.name)}" class="btn-nav">
                                ğŸ“ å°èˆªå‰å¾€
                            </a>
                        </div>
                    </div>
                `;
                area.insertAdjacentHTML('beforeend', card);
            });

            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹ [cite: 7]
            document.querySelectorAll('.day-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`day-btn-${dayNum}`).classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- æš´é¢¨é›ªç›£æ§ç³»çµ± (æ¨¡æ“¬) ---
        function checkBlizzard() {
            // å¯¦å‹™ä¸Šæœƒä¸²æ¥ SafeTravel.is æˆ– IMO API [cite: 9]
            const isStorming = Math.random() > 0.8; // æ¨¡æ“¬ 20% æ©Ÿç‡å‡ºç¾æš´é¢¨é›ª
            const alertBox = document.getElementById('weather-alert');
            
            if (isStorming) {
                alertBox.style.display = 'block';
                // éœ‡å‹•æé†’ (å¦‚æœæ‰‹æ©Ÿæ”¯æ´)
                if ("vibrate" in navigator) navigator.vibrate([500, 200, 500]);
            }
        }

        // --- åˆå§‹åŒ–å°è¦½æŒ‰éˆ• ---
        function initApp() {
            const bar = document.getElementById('day-bar');
            for(let i=1; i<=13; i++) {
                const btn = document.createElement('div');
                btn.className = 'day-btn';
                btn.id = `day-btn-${i}`;
                btn.innerHTML = `<span>D${i}</span>`;
                btn.onclick = () => renderDay(i);
                bar.appendChild(btn);
            }
            renderDay(2); // é è¨­é¡¯ç¤ºå–è»Šæ—¥ [cite: 44]
            checkBlizzard(); // å•Ÿå‹•ç›£æ§ [cite: 9]
        }

        function openComm() {
            const screen = document.getElementById('focus-screen');
            screen.innerText = "Ã‰g Ã¾arf hjÃ¡lp!\n(æˆ‘éœ€è¦å¹«åŠ©)";
            screen.style.display = 'flex';
        }

        window.onload = initApp;
    </script>
</body>
</html>
